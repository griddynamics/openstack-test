Feature: Check keystone service
    In order to smoke test keystone functionality
    As root
    I want to create user, tenant, endpoints in keystone

#    Scenario: Setup prerequisites
#        Require setup "single-node ! keystone ! novaclient-network ! novaclient-images ! novaclient-keys"
#        Require setup "novaclient-images"

    Scenario: Check user creating using keystone
        Given every service is running:
            | ServiceName   |
            {% for service in openstack_services %}
            | {{ service }} |
            {% endfor %}
            | keystone |
        When I create keystone user "{{keystone.admin}}" with password "{{keystone.admin_password}}" in tenant "{{keystone.tenant}}"
        Then I see keystone user "{{keystone.admin}}" exist

    Scenario: Grant permission for keystone user
        Given I see keystone user "{{keystone.admin}}" exist
        When I grant role "Admin" for keystone user "{{keystone.admin}}"
        Then I see role "Admin" granted for keystone user "{{keystone.admin}}"

    Scenario: Create token
        Given I see keystone user "{{keystone.admin}}" exist
        When I create token "{{keystone.token}}" for keystone user "{{keystone.admin}}" in tenant "{{keystone.tenant}}"
        Then I see token "{{keystone.token}}" for keystone user "{{keystone.admin}}" in tenant "{{keystone.tenant}}" exist


